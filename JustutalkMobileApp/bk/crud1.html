<!--main view-->
<div id="main" data-role="view" data-title="Products List" data-model="app.crudService.viewModel" >
    <a id="btnAdd" data-role="button" data-icon="add" data-bind="events: { click: addProduct }">Add Product</a>
    
    <ul id="products" data-role="listview" data-template="productItem" data-style="inset" data-bind="source: dataSource"></ul>

    <ul id="actions" data-role="actionsheet">
        <li class="km-actionsheet-title">Select operation:</li>
        <li><a href="#" data-action="app.crudService.viewModel.showDetails">Details</a></li>
        <li><a href="#" data-action="app.crudService.viewModel.editProduct">Edit</a></li>
        <li><a href="#" data-action="app.crudService.viewModel.destroyProduct">Delete</a></li>
    </ul>
    
</div>

<!--listview template-->
<script id="productItem" type="text/x-kendo-template">
    <span>#: name #</span>
    <a class="btnActions"
       data-role="button"
       data-rel="actionsheet"
       href="\\#actions"
       data-actionsheet-context="#= uid #">Actions</a>
</script>

<!--editor-->
<div id="editor" data-role="view" data-init="editorViewInit" data-show="onViewShow" data-model="app.crudService.viewModel" data-title="Edit Product Information"
>
    <ul id="form" data-role="listview" data-style="inset">
        <li>
            <label>
                Name:
                <input id="name" name="name" type="text" required="required" data-bind="value: selectedProduct.name" />
            </label>
        </li>
        <li>
            <label>
                status:
                <input id="status" name="status" type="number" required="required" data-bind="value: selectedProduct.status" />
            </label>
        </li>
        <li>
            <label>
                email:
                <input id="email" name="email" type="text" required="required" data-bind="value: selectedProduct.email"/>
            </label>
        </li>
        <p data-bind="text: selectedProduct.name" ></p>
    </ul>
    <a id="btnCreate" data-role="button" type="button" data-bind="events: {click: saveProduct}">Save</a>
    <a id="btnCancel" data-role="button" type="button" data-bind="events: {click: cancelChanges}">Cancel</a>
</div>

<!--details view-->
<div id="details" data-role="view" data-show="onViewShow" data-model="app.crudService.viewModel" data-title="Details" data-layout="default">
    <ul id="info" data-role="listview" data-style="inset">
        <li>
            name:
            <span data-bind="text: selectedProduct.name"></span>
        </li>
        <li>
            status:
            <span data-bind="text: selectedProduct.status"></span>
        </li>
        <li>
            email:
            <span data-bind="text: selectedProduct.email"></span>
        </li>
        
    </ul>

    <a id="btnBack" data-role="button" href="#:back">Back</a>
</div>


<script type="text/javascript">
   
    function editorViewInit(e) {
        validator = $("#form").kendoValidator({ //initialize the validator
            messages: {
                required: function(input) { //create a custom message function
                    input.attr("placeholder", input.attr("name") + " is required");
                }
            }
        }).data("kendoValidator");
    }

    function onViewShow(e) {
        
        var uid = e.view.params.uid; //get the query string parameter
        if(uid){
            
            dataItem = app.crudService.viewModel.dataSource.get(uid);
            app.crudService.viewModel.set("selectedProduct", dataItem);  //sets the selected product 
            
        }
        
    }

</script>

<style type="text/css">
    #btnAdd, #btnCreate, #btnCancel, #btnBack {
        display: block;
        line-height: 2em;
        text-align: center;
    }

    #btnAdd {
        margin: 2em;
    }

    #btnCreate, #btnCancel {
        margin: 1em auto 0 auto;
        width: 80%;
    }

    #btnCreate {
        background-color: #00FF00;
    }

    #btnCancel {
        background-color: #FF0000;
    }

    #btnBack {
        margin: 2em auto;
        width: 50%;
    }

    .btnActions {
        float: right;
    }
</style>